# 倉庫工時回報系統 🚀

## 專案簡介

這是一個 Cyberpunk 2077 風格的倉庫工時回報系統，讓倉庫人員可以透過網頁或手機回報每日的工作時間分配。

### ✨ 主要特色

- 🎨 **Cyberpunk 風格** - 黃紅配色，霓虹燈效果
- 📱 **完全響應式** - 支援手機、平板、電腦
- ⚡ **即時計算** - 自動計算總時間、剩餘時間、平均值
- 💾 **自動備份** - LocalStorage 自動儲存，防止資料遺失
- ☁️ **雲端儲存** - 資料自動傳送到 Google Sheets
- ⚠️ **智慧警告** - 超時自動提醒

### 📊 回報內容

9 個工作區域（以分鐘計算）：
1. 晨會
2. 進貨區
3. 檢貨區
4. 拆盒
5. 進包裝機
6. 包貨區
7. 整理環境區
8. 退貨區
9. 其他

**總時間限制：480 分鐘（8 小時）**

---

## 🔧 設定步驟

### 步驟 1：創建 Google Sheets

1. 前往 [Google Sheets](https://sheets.google.com/)
2. 建立新的試算表，命名為「倉庫工時回報」
3. 記下試算表的 ID（在網址列中）

### 步驟 2：設定 Google Apps Script

1. 在 Google Sheets 中，點選 **擴充功能** > **Apps Script**
2. 刪除預設的 `myFunction()`
3. 複製 `google-apps-script.js` 的內容並貼上
4. 點選 **執行** > **setupSheet** 來初始化標題列
5. 授權必要的權限

### 步驟 3：部署 Web App

1. 在 Apps Script 編輯器中，點選 **部署** > **新增部署作業**
2. 選擇類型：**網頁應用程式**
3. 設定：
   - **描述**：倉庫工時回報 API
   - **執行身分**：我
   - **具有應用程式存取權的使用者**：任何人
4. 點選 **部署**
5. **複製「網頁應用程式 URL」**（非常重要！）

### 步驟 4：更新網頁程式碼

1. 開啟 `script.js` 檔案
2. 在第 4 行找到：
   ```javascript
   const WEB_APP_URL = 'YOUR_GOOGLE_APPS_SCRIPT_URL_HERE';
   ```
3. 將 `YOUR_GOOGLE_APPS_SCRIPT_URL_HERE` 替換成剛才複製的 URL
4. 儲存檔案

### 步驟 5：測試系統

1. 用瀏覽器開啟 `index.html`
2. 填寫員工姓名和各區域時間
3. 點選「提交回報」
4. 檢查 Google Sheets 是否有資料

---

## 📱 使用方式

### 填寫回報

1. **輸入姓名**：填寫員工姓名（不可為純數字）
2. **選擇日期**：預設為今天，可以修改
3. **填寫時間**：在各工作區域輸入分鐘數
4. **查看統計**：
   - **總時間**：自動加總
   - **剩餘時間**：480 - 總時間
   - **平均時間**：總時間 ÷ 填寫區域數
5. **提交**：點選「提交回報」按鈕

### 快捷鍵

- `Ctrl/Cmd + Enter`：快速提交
- `Esc`：關閉訊息

### 自動備份

系統會自動儲存你的輸入到瀏覽器，如果不小心關閉頁面，重新開啟會詢問是否載入備份。

---

## 📊 Google Sheets 資料格式

| 欄位 | 說明 |
|------|------|
| A | 提交時間 |
| B | 員工姓名 |
| C | 回報日期 |
| D | 晨會（分鐘） |
| E | 進貨區（分鐘） |
| F | 檢貨區（分鐘） |
| G | 拆盒（分鐘） |
| H | 進包裝機（分鐘） |
| I | 包貨區（分鐘） |
| J | 整理環境區（分鐘） |
| K | 退貨區（分鐘） |
| L | 其他（分鐘） |
| M | 總時間（分鐘） |
| N | 剩餘時間（分鐘） |
| O | 平均時間（分鐘/區） |

### 建議的 Google Sheets 公式

在 Google Sheets 中，你可以新增以下欄位來分析資料：

**計算小時數（P 欄）：**
```
=M2/60
```

**效率評分（Q 欄）：**
```
=IF(M2>480, "超時", IF(M2>=440, "優良", IF(M2>=400, "正常", "不足")))
```

**最常工作區域（R 欄）：**
```
=INDEX(D$1:L$1, MATCH(MAX(D2:L2), D2:L2, 0))
```

---

## 🎨 Cyberpunk 風格說明

### 配色方案

- **主色**：金黃色 (#FFD700) - 標題、重要資訊
- **次色**：紅色 (#FF0000) - 邊框、警告
- **輔色**：橘紅色 (#FF6B00) - 點綴、次要元素
- **背景**：深黑色 (#0a0a0a) - 主背景
- **容器**：深灰色 (#1a1a1a) - 卡片背景

### 特效

- **霓虹燈效果**：text-shadow 和 box-shadow
- **Glitch 故障效果**：標題動畫
- **掃描線**：統計面板動畫
- **懸停效果**：輸入框和按鈕互動

---

## 🔒 安全性考量

1. **資料驗證**：
   - 姓名不可為純數字
   - 時間不可為負數
   - 至少填寫一個區域

2. **防止資料遺失**：
   - LocalStorage 自動備份
   - 離開前確認提示

3. **Google Sheets 權限**：
   - 建議設定為「任何人」可寫入
   - 或限制在組織內部

---

## 📝 客製化選項

### 修改工時上限

在 `script.js` 中修改：
```javascript
const remainingTime = 480 - totalTime; // 改成你要的分鐘數
```

### 新增工作區域

1. 在 `index.html` 新增輸入欄位
2. 在 `script.js` 的 `WORK_AREAS` 陣列新增 ID
3. 在 `google-apps-script.js` 新增對應欄位

### 修改配色

在 `style.css` 的 `:root` 區塊修改：
```css
:root {
    --cyber-yellow: #FFD700;  /* 改成你要的顏色 */
    --cyber-red: #FF0000;
    --cyber-orange: #FF6B00;
}
```

---

## 🐛 常見問題

### Q1：提交後沒有資料出現在 Google Sheets？

**A1：** 檢查以下項目：
1. `script.js` 的 `WEB_APP_URL` 是否正確
2. Google Apps Script 是否已部署
3. 部署時是否選擇「任何人」可存取
4. 瀏覽器開發者工具（F12）是否有錯誤訊息

### Q2：手機版顯示不正常？

**A2：** 確認：
1. 手機瀏覽器版本是否過舊
2. 清除瀏覽器快取後重試
3. 確認 `<meta name="viewport">` 標籤存在

### Q3：備份功能不工作？

**A3：**
1. 確認瀏覽器允許 LocalStorage
2. 不要使用無痕模式
3. 清除瀏覽器資料可能會刪除備份

### Q4：如何查看員工的平均工時？

**A4：**
在 Google Sheets 中使用 AVERAGEIF 函數：
```
=AVERAGEIF(B:B, "員工姓名", M:M)
```

---

## 📞 技術支援

如果遇到問題，請檢查：

1. **瀏覽器控制台**（F12）查看錯誤訊息
2. **Google Apps Script 日誌**：在 Apps Script 中點選「執行」查看
3. **網路連線**：確認可以連上 Google 服務

---

## 📜 版本資訊

- **版本**：2.0
- **最後更新**：2025-01-06
- **相容性**：
  - Chrome 90+
  - Firefox 88+
  - Safari 14+
  - Edge 90+
  - 行動裝置瀏覽器

---

## 🚀 未來功能（可選）

- [ ] 多語言支援
- [ ] 資料視覺化圖表
- [ ] Email 自動通知
- [ ] 歷史紀錄查詢
- [ ] 員工績效分析
- [ ] PDF 報表匯出
- [ ] 離線模式支援

---

## 📄 授權

此專案僅供內部使用。

---

## 🙏 感謝

感謝所有倉庫員工的辛勤工作！

**由 Claude Code 協助開發** 🤖
